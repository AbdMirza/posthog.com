---
title: Sessions
---

Sessions group multiple [traces](/docs/llm-analytics/traces) together that occur during the same user visit or application session. While a trace typically represents a single conversation or workflow, a session represents the broader context of a user's visit to your application.

Sessions are identified using the `$ai_session_id` property, which you can set on any LLM analytics event. By grouping traces with the same session ID, you can:

- Track multiple conversations that happen during the same user visit
- Analyze metrics like "conversations per session" or "cost per user session"
- Understand user behavior across multiple interactions
- Group related but distinct conversations together (e.g., all chats during a single app visit)

## When to use sessions

Sessions are useful when you want to track:

- **Multiple conversations per visit**: A user has several separate conversations during the same app session
- **User behavior patterns**: How users engage with your AI application across multiple interactions
- **Session-level metrics**: Total cost, conversations, or tokens used during a user's visit
- **Conversation frequency**: How many separate conversations users typically have per session

## Traces vs Sessions

It's important to understand the distinction:

- **Trace** (`$ai_trace_id`): Represents a single conversation or workflow. All messages in one back-and-forth conversation should share the same trace ID.
- **Session** (`$ai_session_id`): Groups multiple traces together. When a user starts a new conversation, create a new trace with a different trace ID, but keep the same session ID if it's during the same visit.

## How to set a session ID

You can set the `$ai_session_id` property when capturing LLM events. The session ID should be a unique identifier that represents a user's app visit or session.

**Example scenario**: A user opens your chatbot app and has multiple conversations:

```python
from posthog import Posthog

posthog = Posthog('<ph_project_api_key>')

# Generate a session ID when the user opens your app
session_id = "session_abc123"  # Persists for the entire app visit

# First conversation - Trace 1
posthog.capture(
    distinct_id='user_id',
    event='$ai_trace',
    properties={
        '$ai_session_id': session_id,        # Same session
        '$ai_trace_id': 'trace_conversation1', # Unique trace for this conversation
    }
)

# User starts a NEW conversation - Trace 2
posthog.capture(
    distinct_id='user_id',
    event='$ai_trace',
    properties={
        '$ai_session_id': session_id,        # Same session (still in the same app visit)
        '$ai_trace_id': 'trace_conversation2', # NEW trace for the new conversation
    }
)
```

## Analyzing sessions

Once you've set session IDs on your events, you can analyze them in several ways:

### In the Activity tab

View all traces and events for a specific session by filtering for the `$ai_session_id` property in the [Activity tab](https://app.posthog.com/events).

### In insights

Create insights that aggregate metrics by session:

- Number of conversations (traces) per session
- Average cost per session
- Total tokens used per session
- Session duration
- User engagement patterns across sessions

### In the trace viewer

When viewing a [trace](/docs/llm-analytics/traces), you can see which session it belongs to, helping you understand the broader context of that conversation.

## Best practices

**Use session IDs for app visits**: Generate a session ID when a user opens your application and reuse it for all conversations during that visit. Common approaches:
- Browser session IDs
- App session identifiers
- Time-based session windows (e.g., 30-minute windows)

**Create new traces for new conversations**: When a user starts a new conversation, generate a new trace ID but keep the same session ID (if they're still in the same app visit).

**Consider session boundaries**: Decide what constitutes a "session" in your application:
- A single browser/app session
- A time-based window (e.g., 30 minutes of inactivity starts a new session)
- Explicit user actions (e.g., logging out ends a session)

**Combine with other properties**: Use `$ai_session_id` alongside `$ai_trace_id` and other properties like `distinct_id` or [custom properties](/docs/llm-analytics/custom-properties) to enable rich analysis.
